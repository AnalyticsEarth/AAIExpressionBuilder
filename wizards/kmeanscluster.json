{
  "index":1,
  "name":"K-means Cluster",
  "status":"live",
  "parameters":[
    {
      "index":0,
      "type":"fieldselect",
      "includeinfunction":false,
      "scriptid":"dimension",
      "name":"Dimension"
    },
    {
      "index":1,
      "type":"fieldselect",
      "tag":"$numeric",
      "includeagg":true,
      "includeinfunction":true,
      "scriptid":"measure1",
      "name":"Measure 1"
    },
    {
      "index":2,
      "type":"fieldselect",
      "tag":"$numeric",
      "includeagg":true,
      "includeinfunction":true,
      "scriptid":"measure2",
      "name":"Measure 2"
    }
  ],
  "templates":[
    {
      "id":"0",
      "type":"Measure",
      "name":"K-Means Scatter - Measure 1",
      "description":"Measure 1 for K-Means scatter plot",
      "scriptType":"nativeagg",
      "idForField":"measure1"
    },
    {
      "id":"1",
      "type":"Measure",
      "name":"K-Means Scatter - Measure 2",
      "description":"Measure 2 for k-Means scatter plot",
      "scriptType":"nativeagg",
      "idForField":"measure2"
    },
    {
      "id":"2",
      "type":"Measure",
      "name":"Cluster Number",
      "description":"Returns a K-Means cluster number which is best used as a Color By Measure option",
      "scriptType":"r",
      "qlikfunction":"R.ScriptEval",
      "rscript":"clusterdata <- data.frame(q$##<measure1>##,q$##<measure2>##);clusterdata[is.na(clusterdata)] <- 0;set.seed(20); cluster <- kmeans(clusterdata,4,nstart = 20);cluster$cluster;",
    },
    {
      "id":"3",
      "type":"Dimension",
      "name":"Cluster Dimension",
      "description":"The field for the clusters",
      "scriptType":"nativefield",
      "idForField":"dimension"
    }
  ],
  "viz":[
    {
      "id":"0",
      "type":"clusterscatter",
      "vizicon":"scatter-chart",
      "title":"K-Means Cluster - Scatter Plot",
      "description":"K-means cluster displayed as a scatter plot",
      "replacements":[
        {
          "template":"3",
          "path":"qHyperCubeDef.qDimensions[0]",
          "key":"qLibraryId"
        },
        {
          "template":"0",
          "path":"qHyperCubeDef.qMeasures[0]",
          "key":"qLibraryId"
        },
        {
          "template":"1",
          "path":"qHyperCubeDef.qMeasures[1]",
          "key":"qLibraryId"
        },
        {
          "template":"2",
          "path":"qHyperCubeDef.qDimensions[0].qAttributeExpressions[0]",
          "key":"qLibraryId"
        },
        {
          "template":"2",
          "path":"color.byMeasureDef",
          "key":"key"
        }
      ]
    }
  ]
}
